# Notification Hub

Приложение для рассылки сообщений по нескольким каналам одновременно.

## Руководство по эксплуатации

- Создаём .env и добавляем в него все переменные, которые перечисленны в ```config.py```
(Опционально: для работы авторизации по OAuth 2.0 необходимо зарегистрировать домены для получения кода в Google и Github)
- Из корня проекта стартуем команду ```docker compose up```
- Довольствуемся результатом

## Документация

### auth

Каталог для реализации авторизации по OAuth 2.0 и JWT:

- cookie_auth: Каталог с самописной аутентификацией по JWT
- google/github_router.py: Файлы с эндпоинтами для авторизации по OAuth 2.0
- oauth_google/github.py: Файлы для геенрации ссылки с редиректом
- jwt_parse.py: Файл для парсинга приходящих от гугла jwt
- exceptions.py: Файл с обработками ошибок

### api

Каталог с файлами, в которых осуществляется отправка сообщения по определенным каналам:

- channels_handler.py: Файл с эндпоинтами для отправки сообщения сразу по всем каналам
- channels_helpers.py: Файл с помощниками для channels_handler.py
- telegram_handler.py: Файл с обработкой отправки сообщения через Telegram
- email_handler.py: Файл с обработкой отправки сообщения через Email
- email_helpers.py: Файл с помощниками для email_handler.py
- webhook_handler.py: Файл с обработкой отправки сообщения через Webhook
- texts.py: Файл для генерации текстов ответа для пользователей, которые работают с приложением через API
- exceptions.py: Файл с обработками ошибок

### bot

Каталог с файлами создания бота, обработками базовых команд и генерацией текстов ответа.

### certs

Каталог с приватным и публичным ключами, а также ssl сертификатами.

### database:

Каталог с файлами для взаимодействия с базой данных:

- database.py: Файл с подключением к psql
- managers.py: Файл с классами для взаимодействия с psql и Redis
- models.py: Файл с моделями psql

### templates

Каталог с базовыми html-страницами и файлом ```router.py```.
В файле идет простое подключение html-страниц, а также один API эндпоинт.

### test_main & pytest.ini

Внутри файл с API тестами.

В pytest.ini конфигурация для *pytest*.

### basemodels.py

Файл с Pydantic Basemodel, которые используются для типизации приходящих и отправляемых данных.

### config.py

В файле содржатся классы-настройки для констант, psql и JWT; Также есть функция для настройки логирования.

### exceptions.py

Файл с обработками ошибок.

### main.py

Основной файл с созданием и запуском приложения и бота, корсами и подключением роутеров.

### mypy_validate.py

Файл со скриптом для mypy, который прогоняет его по всем указанным файлапм.

## CI/CD

В пайплайне я добавил всего лишь две джобы: *build* и *test*.
Да, джобы по типу deploy нет, т.к у [render](https://render.com/) CI/CD уже настроено,
но на всякий случай закомментил джобу deploy.

## Примечание

Можете распространять код, делать с ним что угодно, если будут вопросы, то вот почта:
```inksne@gmail.com```